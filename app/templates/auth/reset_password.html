{% extends 'base.html' %}
{% block title %}Reset Password{% endblock %}
{% import 'components/macros.html' as components %}

{% block content %}

<div class="w-full md:w-1/2 px-6 py-10 mx-auto mt-[5vh] min-h-[60vh] md:mt-[10vh] md:min-h-[77vh]">
    <div class="flex justify-center mb-4">
      <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DTPx Logo" class="h-12" />
    </div>
    <h2 class="text-center text-3xl font-semibold mb-3">Update your password</h2>
    <p class="text-center">Set your new password with minimum 8 characters with a<br>combination of letters and numbers</p>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          {{ components.flash_message(category, message) }}
        {% endfor %}
      {% endif %}
    {% endwith %}
    

    <form method="POST" class="space-y-4 mt-8">
      {{ form.hidden_tag() }}

      <div class="mb-4 relative">
        {{ form.password.label(class="block text-sm font-medium text-gray-700 mb-2") }}
        <div class="relative">
          {{ form.password(class=components.input_classes(form.password) + ' pr-10', placeholder="Type your new password", id="password-field") }}
          <button type="button" id="toggle-password" tabindex="-1"
            class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 focus:outline-none toggle-password" data-target="password-field"data-eye-open="eye-open-1" data-eye-closed="eye-closed-1">
            <!-- Eye icon (visible) -->
            <svg id="eye-open-1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <!-- Eye-off icon (hidden, toggled via JS) -->
            <svg id="eye-closed-1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.293-3.95M6.634 6.634A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.956 9.956 0 01-4.293 5.95M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 3l18 18" />
            </svg>
          </button>
        </div>
        {{ components.field_errors(form.password) }}
      </div>

      <div id="password-suggestions" class="grid grid-cols-2 gap-3 mb-8 mt-2 hidden">
        <div id="pw-length" class="flex items-center gap-2 text-red-500">
          <span id="icon-length">✗</span>
          <span>8 characters</span>
        </div>
        <div id="pw-uppercase" class="flex items-center gap-2 text-red-500">
          <span id="icon-uppercase">✗</span>
          <span>Uppercase letter (A-Z)</span>
        </div>
        <div id="pw-number" class="flex items-center gap-2 text-red-500">
          <span id="icon-number">✗</span>
          <span>Number (0-9)</span>
        </div>
        <div id="pw-special" class="flex items-center gap-2 text-red-500">
          <span id="icon-special">✗</span>
          <span>Special character (@#$)</span>
        </div>
      </div>



      <div class="mb-4 relative">
        {{ form.confirm_password.label(class="block text-sm font-medium text-gray-700 mb-2") }}
        <div class="relative">
          {{ form.confirm_password(class=components.input_classes(form.confirm_password) + ' pr-10', placeholder="Re-type your new password", id="confirm-password-field") }}
          <button type="button" id="toggle-password" tabindex="-1"
            class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 focus:outline-none toggle-password" data-target="confirm-password-field" data-eye-open="eye-open-2" data-eye-closed="eye-closed-2">
            <!-- Eye icon (visible) -->
            <svg id="eye-open-2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <!-- Eye-off icon (hidden, toggled via JS) -->
            <svg id="eye-closed-2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.293-3.95M6.634 6.634A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.956 9.956 0 01-4.293 5.95M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 3l18 18" />
            </svg>
          </button>
        </div>
        {{ components.field_errors(form.confirm_password) }}
        {{ components.field_success(form.confirm_password) }}
      </div>


      <div class="mt-4 flex flex-col gap-4">
        {{ form.submit(class=components.button_classes()) }}
        <a href="{{ url_for('auth.login') }}" class="{{ components.button_classes_secondary() }}">Back to Login</a>
      </div>
    </form>  
</div>      


<footer class="text-xs text-center mt-6 text-gray-500">
  © 2025 <strong>Digital Theuphatics</strong>. All rights reserved. 
  <a href="#" class="underline mx-1">Terms & Conditions</a> | 
  <a href="#" class="underline ml-1">Privacy Policy</a>
</footer>
{% endblock %}